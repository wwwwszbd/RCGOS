{"$message_type":"diagnostic","message":"use of inline assembly is unsafe and requires unsafe block","code":{"code":"E0133","explanation":"Unsafe code was used outside of an unsafe block.\n\nErroneous code example:\n\n```compile_fail,E0133\nunsafe fn f() { return; } // This is the unsafe code\n\nfn main() {\n    f(); // error: call to unsafe function requires unsafe function or block\n}\n```\n\nUsing unsafe functionality is potentially dangerous and disallowed by safety\nchecks. Examples:\n\n* Dereferencing raw pointers\n* Calling functions via FFI\n* Calling functions marked unsafe\n\nThese safety checks can be relaxed for a section of the code by wrapping the\nunsafe instructions with an `unsafe` block. For instance:\n\n```\nunsafe fn f() { return; }\n\nfn main() {\n    unsafe { f(); } // ok!\n}\n```\n\nSee the [unsafe section][unsafe-section] of the Book for more details.\n\n#### Unsafe code in functions\n\nUnsafe code is currently accepted in unsafe functions, but that is being phased\nout in favor of requiring unsafe blocks here too.\n\n```\nunsafe fn f() { return; }\n\nunsafe fn g() {\n    f(); // Is accepted, but no longer recommended\n    unsafe { f(); } // Recommended way to write this\n}\n```\n\nLinting against this is controlled via the `unsafe_op_in_unsafe_fn` lint, which\nis `warn` by default in the 2024 edition and `allow` by default in earlier\neditions.\n\n[unsafe-section]: https://doc.rust-lang.org/book/ch19-01-unsafe-rust.html\n"},"level":"warning","spans":[{"file_name":"src/bin/test1_write0.rs","byte_start":281,"byte_end":311,"line_start":19,"line_end":19,"column_start":5,"column_end":35,"is_primary":true,"text":[{"text":"    asm!(\"mv {}, sp\", out(reg) sp);","highlight_start":5,"highlight_end":35}],"label":"use of inline assembly","suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[{"message":"for more information, see <https://doc.rust-lang.org/edition-guide/rust-2024/unsafe-op-in-unsafe-fn.html>","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inline assembly is entirely unchecked and can cause undefined behavior","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"an unsafe function restricts its caller, but its body is safe by default","code":null,"level":"note","spans":[{"file_name":"src/bin/test1_write0.rs","byte_start":226,"byte_end":251,"line_start":17,"line_end":17,"column_start":1,"column_end":26,"is_primary":true,"text":[{"text":"unsafe fn r_sp() -> usize {","highlight_start":1,"highlight_end":26}],"label":null,"suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[],"rendered":null},{"message":"`#[warn(unsafe_op_in_unsafe_fn)]` (part of `#[warn(rust_2024_compatibility)]`) on by default","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"consider wrapping the function body in an unsafe block","code":null,"level":"help","spans":[{"file_name":"src/bin/test1_write0.rs","byte_start":252,"byte_end":252,"line_start":17,"line_end":17,"column_start":27,"column_end":27,"is_primary":true,"text":[{"text":"unsafe fn r_sp() -> usize {","highlight_start":27,"highlight_end":27}],"label":null,"suggested_replacement":"{ unsafe ","suggestion_applicability":"MachineApplicable","expansion":null},{"file_name":"src/bin/test1_write0.rs","byte_start":321,"byte_end":321,"line_start":21,"line_end":21,"column_start":2,"column_end":2,"is_primary":true,"text":[{"text":"}","highlight_start":2,"highlight_end":2}],"label":null,"suggested_replacement":"}","suggestion_applicability":"MachineApplicable","expansion":null}],"children":[],"rendered":null}],"rendered":"\u001b[1m\u001b[33mwarning[E0133]\u001b[0m\u001b[1m: use of inline assembly is unsafe and requires unsafe block\u001b[0m\n  \u001b[1m\u001b[94m--> \u001b[0msrc/bin/test1_write0.rs:19:5\n   \u001b[1m\u001b[94m|\u001b[0m\n\u001b[1m\u001b[94m19\u001b[0m \u001b[1m\u001b[94m|\u001b[0m     asm!(\"mv {}, sp\", out(reg) sp);\n   \u001b[1m\u001b[94m|\u001b[0m     \u001b[1m\u001b[33m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\u001b[0m \u001b[1m\u001b[33muse of inline assembly\u001b[0m\n   \u001b[1m\u001b[94m|\u001b[0m\n   \u001b[1m\u001b[94m= \u001b[0m\u001b[1mnote\u001b[0m: for more information, see <https://doc.rust-lang.org/edition-guide/rust-2024/unsafe-op-in-unsafe-fn.html>\n   \u001b[1m\u001b[94m= \u001b[0m\u001b[1mnote\u001b[0m: inline assembly is entirely unchecked and can cause undefined behavior\n\u001b[1m\u001b[92mnote\u001b[0m: an unsafe function restricts its caller, but its body is safe by default\n  \u001b[1m\u001b[94m--> \u001b[0msrc/bin/test1_write0.rs:17:1\n   \u001b[1m\u001b[94m|\u001b[0m\n\u001b[1m\u001b[94m17\u001b[0m \u001b[1m\u001b[94m|\u001b[0m unsafe fn r_sp() -> usize {\n   \u001b[1m\u001b[94m|\u001b[0m \u001b[1m\u001b[92m^^^^^^^^^^^^^^^^^^^^^^^^^\u001b[0m\n   \u001b[1m\u001b[94m= \u001b[0m\u001b[1mnote\u001b[0m: `#[warn(unsafe_op_in_unsafe_fn)]` (part of `#[warn(rust_2024_compatibility)]`) on by default\n\n"}
{"$message_type":"diagnostic","message":"call to unsafe function `r_sp` is unsafe and requires unsafe block","code":{"code":"E0133","explanation":"Unsafe code was used outside of an unsafe block.\n\nErroneous code example:\n\n```compile_fail,E0133\nunsafe fn f() { return; } // This is the unsafe code\n\nfn main() {\n    f(); // error: call to unsafe function requires unsafe function or block\n}\n```\n\nUsing unsafe functionality is potentially dangerous and disallowed by safety\nchecks. Examples:\n\n* Dereferencing raw pointers\n* Calling functions via FFI\n* Calling functions marked unsafe\n\nThese safety checks can be relaxed for a section of the code by wrapping the\nunsafe instructions with an `unsafe` block. For instance:\n\n```\nunsafe fn f() { return; }\n\nfn main() {\n    unsafe { f(); } // ok!\n}\n```\n\nSee the [unsafe section][unsafe-section] of the Book for more details.\n\n#### Unsafe code in functions\n\nUnsafe code is currently accepted in unsafe functions, but that is being phased\nout in favor of requiring unsafe blocks here too.\n\n```\nunsafe fn f() { return; }\n\nunsafe fn g() {\n    f(); // Is accepted, but no longer recommended\n    unsafe { f(); } // Recommended way to write this\n}\n```\n\nLinting against this is controlled via the `unsafe_op_in_unsafe_fn` lint, which\nis `warn` by default in the 2024 edition and `allow` by default in earlier\neditions.\n\n[unsafe-section]: https://doc.rust-lang.org/book/ch19-01-unsafe-rust.html\n"},"level":"warning","spans":[{"file_name":"src/bin/test1_write0.rs","byte_start":380,"byte_end":386,"line_start":24,"line_end":24,"column_start":14,"column_end":20,"is_primary":true,"text":[{"text":"    let sp = r_sp();","highlight_start":14,"highlight_end":20}],"label":"call to unsafe function","suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[{"message":"for more information, see <https://doc.rust-lang.org/edition-guide/rust-2024/unsafe-op-in-unsafe-fn.html>","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"consult the function's documentation for information on how to avoid undefined behavior","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"an unsafe function restricts its caller, but its body is safe by default","code":null,"level":"note","spans":[{"file_name":"src/bin/test1_write0.rs","byte_start":323,"byte_end":364,"line_start":23,"line_end":23,"column_start":1,"column_end":42,"is_primary":true,"text":[{"text":"unsafe fn stack_range() -> (usize, usize) {","highlight_start":1,"highlight_end":42}],"label":null,"suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[],"rendered":null},{"message":"consider wrapping the function body in an unsafe block","code":null,"level":"help","spans":[{"file_name":"src/bin/test1_write0.rs","byte_start":365,"byte_end":365,"line_start":23,"line_end":23,"column_start":43,"column_end":43,"is_primary":true,"text":[{"text":"unsafe fn stack_range() -> (usize, usize) {","highlight_start":43,"highlight_end":43}],"label":null,"suggested_replacement":"{ unsafe ","suggestion_applicability":"MachineApplicable","expansion":null},{"file_name":"src/bin/test1_write0.rs","byte_start":476,"byte_end":476,"line_start":27,"line_end":27,"column_start":2,"column_end":2,"is_primary":true,"text":[{"text":"}","highlight_start":2,"highlight_end":2}],"label":null,"suggested_replacement":"}","suggestion_applicability":"MachineApplicable","expansion":null}],"children":[],"rendered":null}],"rendered":"\u001b[1m\u001b[33mwarning[E0133]\u001b[0m\u001b[1m: call to unsafe function `r_sp` is unsafe and requires unsafe block\u001b[0m\n  \u001b[1m\u001b[94m--> \u001b[0msrc/bin/test1_write0.rs:24:14\n   \u001b[1m\u001b[94m|\u001b[0m\n\u001b[1m\u001b[94m24\u001b[0m \u001b[1m\u001b[94m|\u001b[0m     let sp = r_sp();\n   \u001b[1m\u001b[94m|\u001b[0m              \u001b[1m\u001b[33m^^^^^^\u001b[0m \u001b[1m\u001b[33mcall to unsafe function\u001b[0m\n   \u001b[1m\u001b[94m|\u001b[0m\n   \u001b[1m\u001b[94m= \u001b[0m\u001b[1mnote\u001b[0m: for more information, see <https://doc.rust-lang.org/edition-guide/rust-2024/unsafe-op-in-unsafe-fn.html>\n   \u001b[1m\u001b[94m= \u001b[0m\u001b[1mnote\u001b[0m: consult the function's documentation for information on how to avoid undefined behavior\n\u001b[1m\u001b[92mnote\u001b[0m: an unsafe function restricts its caller, but its body is safe by default\n  \u001b[1m\u001b[94m--> \u001b[0msrc/bin/test1_write0.rs:23:1\n   \u001b[1m\u001b[94m|\u001b[0m\n\u001b[1m\u001b[94m23\u001b[0m \u001b[1m\u001b[94m|\u001b[0m unsafe fn stack_range() -> (usize, usize) {\n   \u001b[1m\u001b[94m|\u001b[0m \u001b[1m\u001b[92m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\u001b[0m\n\n"}
{"$message_type":"diagnostic","message":"2 warnings emitted","code":null,"level":"warning","spans":[],"children":[],"rendered":"\u001b[1m\u001b[33mwarning\u001b[0m\u001b[1m: 2 warnings emitted\u001b[0m\n\n"}
{"$message_type":"diagnostic","message":"For more information about this error, try `rustc --explain E0133`.","code":null,"level":"failure-note","spans":[],"children":[],"rendered":"\u001b[1mFor more information about this error, try `rustc --explain E0133`.\u001b[0m\n"}
